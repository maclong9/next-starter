# Next.js Application Documentation

## Table of Contents
1. [Introduction](#introduction)
2. [Project Setup](#project-setup)
3. [Theming](#theming)
4. [Adding Modules](#adding-modules)
5. [Testing](#testing)
6. [Authentication](#authentication)
7. [Database](#database)
8. [Folder Structure](#folder-structure)
9. [Development Workflow](#development-workflow)
10. [Deployment](#deployment)

## Introduction

This is a Next.js application built with Kirimase, utilizing various modern web development tools and practices. It includes authentication, database integration, theming capabilities, and a modular structure for easy maintenance and scalability.

## Project Setup

To set up the project:

1. Clone the repository
2. Install dependencies:
   ```
   bun install
   ```
3. Set up environment variables (copy `.env.example` to `.env.local` and fill in the values)
4. Run the development server:
   ```
   bun dev
   ```

## Theming

Theming is implemented using `theme-colors` for generating Tailwind CSS shades. To modify the theme:

1. Edit the `tailwind.config.ts` file to change color definitions.
2. Update the colors in `src/app/globals.css` for styling shadcn components.

To apply a custom font:

1. Use the `next/font` library in the root layout file (`src/app/layout.tsx`).
2. Import and apply the font as shown in the existing layout file.

## Adding Modules

To add additional functionality:

1. Use Kirimase to add modules like Stripe (for payments) or Resend (for email):
   ```
   bunx kirimase@latest add
   ```
2. Follow the prompts to select and configure the desired module.

## Testing

### Unit Testing
- Write unit tests for custom functions and components not generated by Kirimase CLI or maintained by shadcn/acternity-ui.
- Place test files in the same folder as the file being tested.
- Use Vitest for running unit tests:
  ```
  bun test:unit
  ```

### End-to-End Testing
- Use Playwright for end-to-end testing of critical application workflows.
- Avoid testing generated components, actions, or pages.
- Run e2e tests with:
  ```
  bun test:e2e
  ```

## Authentication

Authentication is implemented using Lucia:

1. Sign-up and sign-in functionality is available in `src/app/(auth)/sign-up/page.tsx` and `src/app/(auth)/sign-in/page.tsx`.
2. Authentication logic is handled in `src/lib/auth/lucia.ts` and `src/lib/auth/utils.ts`.
3. Protected routes should use the `checkAuth` function from `src/lib/auth/utils.ts`.

## Database

The project uses Drizzle ORM with PostgreSQL:

1. Database schema is defined in `src/lib/db/schema/auth.ts`.
2. Run migrations with:
   ```
   bun db:migrate
   ```
3. Generate new migrations after schema changes:
   ```
   bun db:generate
   ```

## Folder Structure

- `src/app`: Next.js app router pages and layouts
- `src/components`: Reusable React components
- `src/lib`: Utility functions, database setup, and authentication
- `src/config`: Configuration files (e.g., navigation)
- `public`: Static assets

## Development Workflow

1. Create new components in `src/components`.
2. Add new pages in `src/app`.
3. Update database schema in `src/lib/db/schema`.
4. Run `bun db:generate` after schema changes.
5. Implement server actions in `src/lib/actions`.
6. Use the `getUserAuth` function for accessing user session data.

## Deployment

1. Ensure all environment variables are set in your deployment platform.
2. Run database migrations before deploying new versions.
3. Use the production build command:
   ```
   bun build
   ```
4. Deploy the application to your chosen platform (e.g., Vercel, Netlify).

Remember to keep your dependencies updated and regularly check for security vulnerabilities. Happy coding!